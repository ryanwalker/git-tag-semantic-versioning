#!/usr/bin/env bash

if [[ -z "$1" ]]; then
    echo "Please specify bump type: 'MAJOR', 'MINOR' or 'PATCH'";
    exit 1;
fi

CURRENT_TAG=`git describe`

MAJOR=`echo "$CURRENT_TAG" | sed -E 's/v([0-9]+)\.[0-9]+\.[0-9]+.*/\1/'`
MINOR=`echo "$CURRENT_TAG" | sed -E 's/v[0-9]+\.([0-9]+)\.[0-9]+.*/\1/'`
PATCH=`echo "$CURRENT_TAG" | sed -E 's/v[0-9]+\.[0-9]+\.([0-9])+.*/\1/'`

CURRENT_VERSION="v$MAJOR.$MINOR.$PATCH"

case "$1" in
"MAJOR")
    MAJOR=$((MAJOR+1))
    MINOR=0
    PATCH=0
    ;;
"MINOR")
    MINOR=$((MINOR+1))
    PATCH=0
    ;;
"PATCH")
    PATCH=$((PATCH+1))
    ;;
esac

NEW_VERSION="v$MAJOR.$MINOR.$PATCH"

#git tag -am "v$MAJOR.$MINOR.$PATCH" "v$MAJOR.$MINOR.$PATCH"
echo "v$MAJOR.$MINOR.$PATCH"
